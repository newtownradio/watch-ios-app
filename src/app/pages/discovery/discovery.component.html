<div class="discovery-page">
  <div class="page-header">
    <h1>Discovery</h1>
    <p>Find your perfect timepiece</p>
  </div>

  <!-- Search and Filters -->
  <div class="search-section">
    <div class="search-bar">
      <div class="search-input-group">
        <input 
          type="text" 
          [(ngModel)]="searchTerm" 
          placeholder="Search watches, sellers..."
          class="search-input"
          id="search-input"
          (keyup.enter)="performSearch()"
        >
        <button class="search-btn" (click)="performSearch()" type="button">
          üîç
        </button>
      </div>
    </div>

    <div class="filters">
      <div class="price-range">
        <label for="min-price">Price Range:</label>
        <div class="price-inputs">
          <input 
            type="number" 
            [(ngModel)]="minPrice" 
            placeholder="Min"
            class="price-input"
            id="min-price"
          >
          <span>-</span>
          <input 
            type="number" 
            [(ngModel)]="maxPrice" 
            placeholder="Max"
            class="price-input"
            id="max-price"
          >
        </div>
      </div>

      <div class="favorites-filter">
        <label class="checkbox-label" for="favorites-only">
          <input 
            type="checkbox" 
            [(ngModel)]="showFavoritesOnly"
            class="checkbox"
            id="favorites-only"
          >
          <span>Favorites only</span>
        </label>
      </div>

      <div class="filter-buttons">
        <button class="search-filters-btn" (click)="performSearch()" type="button">
          Search
        </button>
        <button class="clear-btn" (click)="clearFilters()" type="button">
          Clear Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Results Count -->
  <div class="results-info">
    <p>{{ filteredListings.length }} items found</p>
  </div>

  <!-- Listings Grid -->
  <div class="products-grid">
    <div class="product-card" *ngFor="let listing of filteredListings">
      <div class="product-image">
        <img [src]="listing.imageUrl || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPldhdGNoPC90ZXh0Pjwvc3ZnPg=='" [alt]="listing.title">
        <button class="favorite-btn" (click)="toggleFavorite(listing.id)">
          {{ isFavorited(listing.id) ? '‚ù§Ô∏è' : 'ü§ç' }}
        </button>
      </div>
      <div class="product-info">
        <h3>{{ listing.title }}</h3>
        <p class="price">${{ listing.currentPrice.toLocaleString() }}</p>
        <p class="description">{{ listing.description }}</p>
        <div class="watch-details" *ngIf="listing.brand || listing.model">
          <span class="brand-model" *ngIf="listing.brand && listing.model">
            {{ listing.brand }} {{ listing.model }}
          </span>
          <span class="condition" *ngIf="listing.condition">
            Condition: {{ listing.condition }}
          </span>
        </div>
        <div class="seller">
          <span>{{ listing.sellerName }}</span>
          <span>‚≠ê 4.8</span>
        </div>
        <div class="listing-details">
          <span class="time-remaining">
            {{ getTimeRemaining(listing.endTime) }} left
          </span>
          <span class="bids-count" *ngIf="listing.bids.length > 0">
            {{ listing.bids.length }} bid{{ listing.bids.length > 1 ? 's' : '' }}
          </span>
        </div>
        <div class="listing-times">
          <span class="posted-time">
            Posted: {{ getListingStartTime(listing.createdAt) }}
          </span>
          <span class="ends-time">
            Ends: {{ getListingEndTime(listing.endTime) }}
          </span>
        </div>
        <button class="share-btn" (click)="shareListing(listing)" title="Share this listing">
          üì§ Share
        </button>
      </div>
    </div>
  </div>

  <!-- No Results Message -->
  <div class="no-results" *ngIf="filteredListings.length === 0">
    <p>No listings found matching your criteria</p>
    <button class="clear-btn" (click)="clearFilters()">Clear Filters</button>
  </div>
</div>